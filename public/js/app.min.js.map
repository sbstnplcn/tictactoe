{"version":3,"sources":["src/js/app.js","src/js/components/game/game.md.js","src/js/components/login/login.md.js","src/js/config/config.md.js","src/js/services/services.md.js","src/js/components/game/game.js","src/js/components/login/login.js","src/js/config/router.js","src/js/services/gameFactory.js","src/js/services/socketFactory.js","src/js/services/usersService.js"],"names":["app","angular","module","component","templateUrl","controller","usersService","$state","socket","$scope","gameFactory","extend","$onInit","table","tic","getCurrent","then","user","currentUser","emit","catch","go","on","OtherUser","otherUser","filter","a","_id","forEach","row","console","log","ptidx","idx","value","player","name","click","disconnect","res","reload","connect","add","newUser","config","$stateProvider","$urlRouterProvider","otherwise","state","url","abstract","template","$stateParams","token","setToken","factory","$rootScope","io","eventName","callback","args","arguments","$apply","apply","data","service","$http","$cookies","$q","$window","get","getPopulate","users","userId","post","edit","put","delete","Promise","resolve","reject","remove","deferred","defer","payload","split","atob","JSON","parse","_doc","Math","round","Date","getTime","exp","promise"],"mappings":"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","file":"public/js/app.min.js","sourcesContent":["((app) => {\n    'use strict'\n})(angular.module('app', [\n    'ui.router',\n    'ngCookies',\n    'app.views',\n    'app.config',\n    'app.services',\n    'app.login',\n    'app.game'\n]))\n","((app)=>{\n  'use strict'\n\n})(angular.module('app.game', []))\n","((app) => {\n\n})(angular.module('app.login', []))\n","((app) => {\n    'use strict'\n})(angular.module('app.config', []))\n","((app)=>{\n\n})(angular.module('app.services', []))\n","((app) => {\n    'use strict'\n    app.component('game', {\n        templateUrl: 'js/components/game/game.html',\n        controller: ['usersService', '$state', 'socket', '$scope', 'gameFactory', function(usersService, $state, socket, $scope, gameFactory) {\n            angular.extend(this, {\n                $onInit() {\n\n                    //init table\n                    let table = gameFactory.table\n                    this.tic = table\n\n                    //if disconnect, go to login page\n                    usersService.getCurrent().then((user) => {\n                        this.currentUser = user\n                        socket.emit('userInfos', this.currentUser)\n                    }).catch(() => {\n                        $state.go('app.login')\n                    })\n\n                    // Get Player 2\n                    socket.on('allUsers', (OtherUser) => {\n                        this.otherUser = OtherUser.filter((a) => {\n                            return a._id !== this.currentUser._id\n                        })\n                    })\n\n                    // receive new table\n                    socket.on('playValue', (socket) => {\n                        socket.tic.forEach((row) => {\n                            // console.log(socket.tic, row)\n                            console.log(socket.tic[socket.ptidx][socket.idx].value);\n                            return row[socket.idx].player == this.currentUser.name ?\n                                socket.tic[socket.ptidx][socket.idx].value = \"x\" :\n                                socket.tic[socket.ptidx][socket.idx].value = \"o\"\n                        })\n                        this.tic = socket.tic\n                    })\n                    //emit on click\n                    this.click = (ptidx, idx) => {\n                        let tic = this.tic\n                        tic[ptidx][idx].player = this.currentUser.name\n                        socket.emit('play', {\n                            ptidx,\n                            idx,\n                            tic\n                        })\n                    }\n                },\n                disconnect() {\n                    usersService.disconnect().then((res) => {\n                        $state.go('app.login').then(() => {\n                            $state.reload()\n                        })\n                    })\n                }\n            })\n        }]\n    })\n})(angular.module('app.game'))\n","((app) => {\n    'use strict'\n    app.component('login', {\n        templateUrl: 'js/components/login/login.html',\n        controller: ['usersService', '$state', function(usersService, $state) {\n            angular.extend(this, {\n                $onInit() {\n\n                },\n                connect() {\n                    usersService.connect(this.user).then((res) => {\n                        $state.go('app.game').then(() => {\n                            $state.reload()\n                        })\n                    })\n                },\n                // add User\n                add() {\n                    usersService.add(this.newUser).then((res) => {\n                        usersService.connect(this.newUser).then((res) => {\n                            $state.go('app.game').then(() => {\n                                $state.reload()\n                            })\n                        })\n                    })\n                }\n            })\n        }]\n    })\n})(angular.module('app.login'))\n","((app) => {\n    'use strict'\n    app.config(['$stateProvider', '$urlRouterProvider', ($stateProvider, $urlRouterProvider) => {\n        $urlRouterProvider.otherwise('/')\n        $stateProvider.state('app', {\n            url: '',\n            abstract: true,\n            template: '<ui-view></ui-view>'\n        })\n        .state('app.game', {\n            url: '/',\n            template: '<game></game>'\n        })\n        .state('app.login', {\n            url: '/login',\n            template: '<login></login>'\n        })\n        .state('callback', {\n            url: '/auth/callback/:token',\n            template: '',\n            controller: ['usersService', '$stateParams', '$state', function(usersService, $stateParams, $state) {\n                if ($stateParams.token) {\n                    usersService.setToken($stateParams.token).then((user) => {\n                        $state.go('app.login')\n                    })\n                } else {\n                    $state.go('app.login')\n                }\n            }]\n        })\n    }])\n\n})(angular.module('app.config'))\n","((app) => {\n    'use strict'\n    app.factory('gameFactory', [function() {\n        return {\n            \"table\": [\n                [{\n                    \"player\": \"\",\n                    \"value\": \"\"\n                }, {\n                    \"player\": \"\",\n                    \"value\": \"\"\n                }, {\n                    \"player\": \"\",\n                    \"value\": \"\"\n                }],\n                [{\n                    \"player\": \"\",\n                    \"value\": \"\"\n                }, {\n                    \"player\": \"\",\n                    \"value\": \"\"\n                }, {\n                    \"player\": \"\",\n                    \"value\": \"\"\n                }],\n                [{\n                    \"player\": \"\",\n                    \"value\": \"\"\n                }, {\n                    \"player\": \"\",\n                    \"value\": \"\"\n                }, {\n                    \"player\": \"\",\n                    \"value\": \"\"\n                }]\n            ]\n\n        }\n    }])\n})(angular.module('app.services'))\n","((app) => {\n    'use strict'\n    app.factory('socket', function($rootScope) {\n        var socket = io.connect('http://localhost:9000/');\n        return {\n            on(eventName, callback) {\n                socket.on(eventName, function() {\n                    var args = arguments;\n                    $rootScope.$apply(function() {\n                        callback.apply(socket, args);\n                    });\n                });\n            },\n            emit(eventName, data, callback) {\n                socket.emit(eventName, data, function() {\n                    var args = arguments;\n                    $rootScope.$apply(function() {\n                        if (callback) {\n                            callback.apply(socket, args);\n                        }\n                    });\n                })\n            }\n        };\n    });\n})(angular.module('app.services'))\n","((app) => {\n    'use strict'\n    app.service('usersService', ['$http', '$cookies', '$q', '$window', function($http, $cookies, $q, $window) {\n        return {\n            get() {\n                return $http.get('/api/users')\n            },\n            getPopulate(users) {\n                return $http.get('/api/users/' + users.userId)\n            },\n            add(newUser) {\n                return $http.post('/api/users', newUser)\n            },\n            edit(user) {\n                return $http.put('/api/users/' + user._id, user)\n            },\n            delete(user) {\n                return $http.delete('/api/users/' + user._id)\n            },\n            connect(data) {\n                return $http.post('/api/auth', data).then((res) => {\n                    this.currentUser = res.data.user\n                    $cookies.put('token', res.data.token)\n                })\n            },\n            disconnect() {\n                return new Promise((resolve, reject) => {\n                    $cookies.remove(\"token\")\n                    this.currentUser = null\n                    resolve()\n                })\n            },\n            getCurrent() {\n\n                let deferred = $q.defer()\n                if (!$cookies.get('token')) {\n                    deferred.reject()\n                } else {\n                    if (!this.currentUser) {\n                        let payload = $cookies.get('token').split('.')[1]\n                        payload = $window.atob(payload)\n                        payload = JSON.parse(payload)\n                        this.currentUser = payload._doc\n                        if (Math.round(new Date().getTime() / 1000) > payload.exp)\n                            return this.disconnect()\n                    }\n                    deferred.resolve(this.currentUser)\n                }\n\n                return deferred.promise\n            }\n        }\n    }])\n})(angular.module('app.services'))\n"]}