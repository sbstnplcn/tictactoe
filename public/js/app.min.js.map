{"version":3,"sources":["src/js/app.js","src/js/components/game/game.md.js","src/js/components/login/login.md.js","src/js/config/config.md.js","src/js/services/services.md.js","src/js/components/game/game.js","src/js/components/login/login.js","src/js/config/router.js","src/js/services/socketFactory.js","src/js/services/usersService.js"],"names":["app","angular","module","component","templateUrl","controller","usersService","$state","socket","$scope","extend","$onInit","table","player","value","tic","getCurrent","then","user","currentUser","emit","catch","go","on","OtherUser","otherUser","filter","a","_id","click","ptidx","idx","disconnect","res","reload","connect","add","newUser","config","$stateProvider","$urlRouterProvider","otherwise","state","url","abstract","template","$stateParams","token","setToken","factory","$rootScope","io","eventName","callback","args","arguments","$apply","apply","data","service","$http","$cookies","$q","$window","get","getPopulate","users","userId","post","edit","put","delete","Promise","resolve","reject","remove","deferred","defer","payload","split","atob","JSON","parse","_doc","Math","round","Date","getTime","exp","promise"],"mappings":"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","file":"public/js/app.min.js","sourcesContent":["((app) => {\n    'use strict'\n})(angular.module('app', [\n    'ui.router',\n    'ngCookies',\n    'app.views',\n    'app.config',\n    'app.services',\n    'app.login',\n    'app.game'\n]))\n","((app)=>{\n  'use strict'\n\n})(angular.module('app.game', []))\n","((app) => {\n\n})(angular.module('app.login', []))\n","((app) => {\n    'use strict'\n})(angular.module('app.config', []))\n","((app)=>{\n\n})(angular.module('app.services', []))\n","((app) => {\n    'use strict'\n    app.component('game', {\n        templateUrl: 'js/components/game/game.html',\n        controller: ['usersService', '$state', 'socket', '$scope', function(usersService, $state, socket, $scope) {\n            angular.extend(this, {\n                $onInit() {\n\n                    var table = [\n                        [{\n                            player: \"\",\n                            value: \"\"\n                        }, {\n                            player: \"\",\n                            value: \"\"\n                        }, {\n                            player: \"\",\n                            value: \"\"\n                        }],\n                        [{\n                            player: \"\",\n                            value: \"\"\n                        }, {\n                            player: \"\",\n                            value: \"\"\n                        }, {\n                            player: \"\",\n                            value: \"\"\n                        }],\n                        [{\n                            player: \"\",\n                            value: \"\"\n                        }, {\n                            player: \"\",\n                            value: \"\"\n                        }, {\n                            player: \"\",\n                            value: \"\"\n                        }]\n                    ]\n\n                    this.tic = table\n\n                    //if disconnect, go to login page\n                    usersService.getCurrent().then((user) => {\n                        this.currentUser = user\n                        socket.emit('userInfos', this.currentUser)\n                    }).catch(() => {\n                        $state.go('app.login')\n                    })\n\n                    // Get Player 2\n                    socket.on('allUsers', (OtherUser) => {\n                        this.otherUser = OtherUser.filter((a) => {\n                            return a._id !== this.currentUser._id\n                        })\n                    })\n\n                    // receive new table\n                    socket.on('playValue', (socket) => {\n                        this.tic = socket.tic\n                    })\n                },\n                //emit on click\n                click(ptidx, idx) {\n                    let tic = this.tic\n                    tic[ptidx][idx].value = 'x'\n                    socket.emit('play', {\n                        ptidx,\n                        idx,\n                        tic\n                    })\n                },\n                disconnect() {\n                    usersService.disconnect().then((res) => {\n                        $state.go('app.login').then(() => {\n                            $state.reload()\n                        })\n                    })\n                }\n            })\n        }]\n    })\n})(angular.module('app.game'))\n","((app) => {\n    'use strict'\n    app.component('login', {\n        templateUrl: 'js/components/login/login.html',\n        controller: ['usersService', '$state', function(usersService, $state) {\n            angular.extend(this, {\n                $onInit() {\n\n                },\n                connect() {\n                    usersService.connect(this.user).then((res) => {\n                        $state.go('app.game').then(() => {\n                            $state.reload()\n                        })\n                    })\n                },\n                // add User\n                add() {\n                    usersService.add(this.newUser).then((res) => {\n                        usersService.connect(this.newUser).then((res) => {\n                            $state.go('app.game').then(() => {\n                                $state.reload()\n                            })\n                        })\n                    })\n                }\n            })\n        }]\n    })\n})(angular.module('app.login'))\n","((app) => {\n    'use strict'\n    app.config(['$stateProvider', '$urlRouterProvider', ($stateProvider, $urlRouterProvider) => {\n        $urlRouterProvider.otherwise('/')\n        $stateProvider.state('app', {\n            url: '',\n            abstract: true,\n            template: '<ui-view></ui-view>'\n        })\n        .state('app.game', {\n            url: '/',\n            template: '<game></game>'\n        })\n        .state('app.login', {\n            url: '/login',\n            template: '<login></login>'\n        })\n        .state('callback', {\n            url: '/auth/callback/:token',\n            template: '',\n            controller: ['usersService', '$stateParams', '$state', function(usersService, $stateParams, $state) {\n                if ($stateParams.token) {\n                    usersService.setToken($stateParams.token).then((user) => {\n                        $state.go('app.login')\n                    })\n                } else {\n                    $state.go('app.login')\n                }\n            }]\n        })\n    }])\n\n})(angular.module('app.config'))\n","((app) => {\n    'use strict'\n    app.factory('socket', function($rootScope) {\n        var socket = io.connect('http://localhost:9000/tictactoe');\n        return {\n            on(eventName, callback) {\n                socket.on(eventName, function() {\n                    var args = arguments;\n                    $rootScope.$apply(function() {\n                        callback.apply(socket, args);\n                    });\n                });\n            },\n            emit(eventName, data, callback) {\n                socket.emit(eventName, data, function() {\n                    var args = arguments;\n                    $rootScope.$apply(function() {\n                        if (callback) {\n                            callback.apply(socket, args);\n                        }\n                    });\n                })\n            }\n        };\n    });\n})(angular.module('app.services'))\n","((app) => {\n    'use strict'\n    app.service('usersService', ['$http', '$cookies', '$q', '$window', function($http, $cookies, $q, $window) {\n        return {\n            get() {\n                return $http.get('/api/users')\n            },\n            getPopulate(users) {\n                return $http.get('/api/users/' + users.userId)\n            },\n            add(newUser) {\n                return $http.post('/api/users', newUser)\n            },\n            edit(user) {\n                return $http.put('/api/users/' + user._id, user)\n            },\n            delete(user) {\n                return $http.delete('/api/users/' + user._id)\n            },\n            connect(data) {\n                return $http.post('/api/auth', data).then((res) => {\n                    this.currentUser = res.data.user\n                    $cookies.put('token', res.data.token)\n                })\n            },\n            disconnect() {\n                return new Promise((resolve, reject) => {\n                    $cookies.remove(\"token\")\n                    this.currentUser = null\n                    resolve()\n                })\n            },\n            getCurrent() {\n\n                let deferred = $q.defer()\n                if (!$cookies.get('token')) {\n                    deferred.reject()\n                } else {\n                    if (!this.currentUser) {\n                        let payload = $cookies.get('token').split('.')[1]\n                        payload = $window.atob(payload)\n                        payload = JSON.parse(payload)\n                        this.currentUser = payload._doc\n                        if (Math.round(new Date().getTime() / 1000) > payload.exp)\n                            return this.disconnect()\n                    }\n                    deferred.resolve(this.currentUser)\n                }\n\n                return deferred.promise\n            }\n        }\n    }])\n})(angular.module('app.services'))\n"]}